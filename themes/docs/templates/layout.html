<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ .Title }} | {{ .Config.Title }}</title>
    
    <!-- Google Fonts - Nexus Prime Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    {{ if .Assets }}
    <link rel="stylesheet" href="{{ .BaseURL }}{{ index .Assets "/static/css/theme.css" }}">
    <link rel="stylesheet" href="{{ .BaseURL }}{{ index .Assets "/static/css/layout.css" }}">
    <link rel="stylesheet" href="{{ .BaseURL }}{{ index .Assets "/static/css/components/admonitions.css" }}">
    <link rel="stylesheet" href="{{ .BaseURL }}{{ index .Assets "/static/css/components/modal.css" }}">
    <link rel="stylesheet" href="{{ .BaseURL }}{{ index .Assets "/static/css/syntax.css" }}">
    {{ else }}
    <link rel="stylesheet" href="{{ .BaseURL }}/static/css/theme.css">
    <link rel="stylesheet" href="{{ .BaseURL }}/static/css/layout.css">
    <link rel="stylesheet" href="{{ .BaseURL }}/static/css/components/admonitions.css">
    <link rel="stylesheet" href="{{ .BaseURL }}/static/css/components/modal.css">
    <link rel="stylesheet" href="{{ .BaseURL }}/static/css/syntax.css">
    {{ end }}
    
    {{ if .Config.Logo }}
    <link rel="icon" type="image/png" href="{{ .BaseURL }}/{{ .Config.Logo }}">
    {{ else }}
    <link rel="icon" type="image/png" href="{{ .BaseURL }}/static/images/favicon.png">
    {{ end }}
    <script>
        // Immediate Theme Application to prevent flash
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();
    </script>
</head>

<body>

    <div class="docs-layout">
        <!-- Header -->
        <header class="docs-header">
            <div class="logo">
                <a href="{{ .BaseURL }}/" class="logo-link">
                    {{ if .Config.Logo }}
                    <img src="{{ .BaseURL }}/{{ .Config.Logo }}" alt="Logo" class="site-logo">
                    {{ else }}
                    <span>üìö</span>
                    {{ end }}
                    <span>{{ .Config.Title }}</span>
                </a>
            </div>
            <nav>
                <button id="search-btn" class="search-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    <span>Search</span>
                    <span class="search-shortcut">Ctrl K</span>
                </button>
                {{ if .Versions }}
                <select id="version-selector" class="version-selector"
                    onchange="if(!window.versionSwitcherEnabled){window.location.href=this.value}">
                    {{ range .Versions }}
                    <option value="{{ .URL }}" {{ if .IsCurrent }}selected{{ end }}>
                        {{ .Name }}
                    </option>
                    {{ end }}
                </select>
                {{ end }}
                <button id="theme-toggle">üåô</button>
            </nav>
        </header>

        {{ if .IsOutdated }}
        <div class="version-banner">
            <span class="version-banner-text">
                You are viewing {{ .CurrentVersion }}.
                {{ range .Versions }}{{ if .IsLatest }}<a href="{{ .URL }}">View latest version</a>{{ end }}{{ end }}
            </span>
        </div>
        {{ end }}

        {{ if .Breadcrumbs }}
        <nav class="breadcrumbs">
            {{ range .Breadcrumbs }}
            {{ if .IsCurrent }}
            <span class="breadcrumb-current">{{ .Title }}</span>
            {{ else }}
            <a href="{{ .Link }}" class="breadcrumb-link">{{ .Title }}</a>
            <span class="breadcrumb-separator">/</span>
            {{ end }}
            {{ end }}
        </nav>
        {{ end }}

        <!-- Sidebar (Recursive Tree) -->
        <aside class="docs-sidebar">
            {{ define "tree-node" }}
            <li class="tree-item {{ if .Children }}has-children{{ end }}">
                <div class="tree-row">
                    {{ if .Children }}
                    <button class="tree-toggle" aria-label="Toggle Section">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                            <path d="m9 18 6-6-6-6"></path>
                        </svg>
                    </button>
                    {{ end }}
                    
                    {{ if .Link }}
                    <a href="{{ .Link }}" class="tree-link {{ if .Active }}active{{ end }}">
                        {{ .Title }}
                    </a>
                    {{ else }}
                    <span class="tree-label">{{ .Title }}</span>
                    {{ end }}
                </div>

                {{ if .Children }}
                <ul class="tree-group collapsed">
                    {{ range .Children }}
                    {{ template "tree-node" . }}
                    {{ end }}
                </ul>
                {{ end }}
            </li>
            {{ end }}

            <ul class="tree-root">
                {{ range .SiteTree }}
                {{ template "tree-node" . }}
                {{ end }}
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="docs-main">
            <article>
                <div class="article-header">
                    <h1>{{ .Title }}</h1>
                    <div class="meta">
                        {{ if .ReadingTime }}<span class="badge">‚è±Ô∏è {{ .ReadingTime }} min read</span>{{ end }}
                        {{ if .Config.Features.RawMarkdown }}
                        <a href="{{ .Permalink | replace ".html" ".md" }}" target="_blank" class="badge source-link">
                            View Source
                        </a>
                        {{ end }}
                    </div>
                </div>

                <div class="content">
                    {{ .Content }}
                </div>

                {{ if or .PrevPage .NextPage }}
                <nav class="page-nav">
                    {{ if .PrevPage }}
                    <a href="{{ .PrevPage.Link }}" class="page-nav-prev">
                        <span class="page-nav-label">‚Üê Previous</span>
                        <span class="page-nav-title">{{ .PrevPage.Title }}</span>
                    </a>
                    {{ else }}
                    <span class="page-nav-placeholder"></span>
                    {{ end }}

                    {{ if .NextPage }}
                    <a href="{{ .NextPage.Link }}" class="page-nav-next">
                        <span class="page-nav-label">Next ‚Üí</span>
                        <span class="page-nav-title">{{ .NextPage.Title }}</span>
                    </a>
                    {{ else }}
                    <span class="page-nav-placeholder"></span>
                    {{ end }}
                </nav>
                {{ end }}
            </article>
        </main>

        <!-- TOC -->
        <aside class="docs-toc">
            <strong>On this page</strong>
            {{ if .TOC }}
            <nav class="toc-nav">
                <ul class="toc-list">
                    {{ range .TOC }}
                    <li class="toc-item" data-level="{{ .Level }}">
                        <a href="#{{ .ID }}" class="toc-link">{{ .Text }}</a>
                    </li>
                    {{ end }}
                </ul>
            </nav>
            {{ end }}
        </aside>
    </div>

    <div id="search-modal" class="modal">
        <div class="modal-content">
            <div class="search-header">
                <input type="text" id="search-input" placeholder="Search docs..."
                    autocomplete="off">
                <span class="close-search">&times;</span>
            </div>
            <div class="search-options">
                <label class="search-option">
                    <input type="checkbox" id="search-all-versions">
                    <span>Search all versions</span>
                </label>
            </div>
            <div id="search-results"></div>
            <div class="search-footer">
                Search docs | <kbd>Esc</kbd> to close | <kbd>‚Üë‚Üì</kbd> to navigate
            </div>
        </div>
    </div>

    <script>window.siteBaseURL = "{{ .BaseURL }}";</script>
    {{ if .Assets }}
    <script defer src="{{ .BaseURL }}{{ index .Assets "/static/js/wasm_exec.js" }}"></script>
    <script defer src="{{ .BaseURL }}{{ index .Assets "/static/js/search.js" }}"></script>
    <script defer src="{{ .BaseURL }}{{ index .Assets "/static/js/version-switcher.js" }}"></script>
    <script defer src="{{ .BaseURL }}{{ index .Assets "/static/js/docs-features.js" }}"></script>
    {{ end }}
</body>

</html>
